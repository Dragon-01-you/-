# 江西工业工程职业技术学院智能问答系统 - 测试与使用说明

## 系统概述

本系统是一个基于FastAPI的智能问答后端服务，能够处理学校相关问题，并支持集成大模型API进行更智能的回答生成。系统包含向量数据库存储知识库信息，并支持实时搜索判断。

## 测试工具

系统提供了两个测试脚本：

### 1. 基础测试脚本 (`test_api.py`)

用于快速测试API的基本功能，包括健康检查和简单的问答测试。

**使用方法：**
```bash
python test_api.py
```

### 2. 全面测试脚本 (`comprehensive_test.py`)

提供了更全面的测试，包括：
- 健康检查
- 简单问答测试
- 多轮对话测试
- 不同类型问题的测试（基本信息、学生服务、教学相关、实时信息等）

**使用方法：**
```bash
python comprehensive_test.py
```

## 大模型API配置

要启用真实的大模型回答功能，请按照以下步骤配置：

1. 打开 `api_server.py` 文件
2. 找到 `MODEL_CONFIG` 部分
3. 填写您的API信息：

```python
MODEL_CONFIG = {
    "api_base": "https://api.example.com/v1/chat/completions",  # 您的API地址
    "api_key": "sk-xxx",  # 您的API密钥
    "model_name": "gpt-4-turbo",  # 模型名称
    "timeout": 100  # API调用超时时间（秒）
}
```

4. 保存文件后，重启服务：
```bash
# 先停止当前服务（如果运行中）
# 然后重启
python api_server.py
```

## 服务管理

### 启动后端服务

```bash
cd c:\Users\ASUS\Desktop\jxiee_ai_assistant
python api_server.py
```

服务将运行在 `http://0.0.0.0:8000`

### 启动前端服务

```bash
cd c:\Users\ASUS\Desktop\jxiee_ai_assistant\OKComputer_江西工业智能问答前端
python -m http.server 8080
```

前端将在 `http://localhost:8080` 访问

## API端点

### 1. 健康检查

- **URL**: `/health`
- **方法**: `GET`
- **功能**: 检查系统状态和向量数据库状态
- **返回**: `{"status": "healthy", "vector_db_status": "initialized"}`

### 2. 问答接口

- **URL**: `/ask`
- **方法**: `POST`
- **请求体**: 
  ```json
  {
    "question": "您的问题",
    "chat_history": [
      {"role": "user", "content": "历史问题"},
      {"role": "assistant", "content": "历史回答"}
    ]
  }
  ```
- **返回**: 
  ```json
  {
    "answer": "回答内容",
    "is_real_time": false,
    "sources": ["来源1", "来源2"]
  }
  ```

## 测试流程

### 基本测试流程

1. 启动后端服务
2. 运行 `python test_api.py` 进行基础测试
3. 运行 `python comprehensive_test.py` 进行全面测试
4. 启动前端服务，在浏览器中测试用户界面

### 大模型API集成测试

1. 配置大模型API信息
2. 重启后端服务
3. 运行测试脚本验证大模型回答功能
4. 通过前端界面体验实际效果

## 注意事项

1. 请确保API密钥的安全，不要泄露
2. 首次启动时，系统会初始化向量数据库
3. 如果遇到API调用超时，可以适当调整 `timeout` 参数
4. 测试脚本中的超时设置可能需要根据实际网络情况调整

## 故障排除

### 常见问题

1. **服务启动失败**
   - 检查端口是否被占用
   - 检查Python环境和依赖是否正确安装

2. **API返回错误**
   - 检查大模型API配置是否正确
   - 查看终端日志获取详细错误信息

3. **响应时间过长**
   - 检查网络连接
   - 调整超时参数

4. **向量数据库错误**
   - 确保 `vector_db` 目录存在且有读写权限

## 联系信息

如有问题或需要帮助，请联系系统管理员。

---

*文档最后更新时间：2025年*